(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var r=e.g.document;if(!t&&r&&(r.currentScript&&(t=r.currentScript.src),!t)){var n=r.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=e.p+"08e1a671094cefd9763ac7d23b49f82c.gif";function r(e,t){e.innerHTML="";let r=!0;for(let n=0;n<t.length;n++){const s=document.createElement("span"),o=1.5*Math.random()+1,c=1,a=.25*Math.random()+.1;let i;s.style.transition=`opacity ${o}s`,s.innerHTML=t[n],s.style.opacity=[c,a][Math.floor(2*Math.random())];const u=()=>{s.style.opacity===String(c)?s.style.opacity=String(a):s.style.opacity=String(c),i=setTimeout((()=>{r&&u()}),1e3*Math.random()+1e3*o)};i=setTimeout((()=>{u()}),100),e.appendChild(s)}return()=>{r=!1}}function n(){const e=document.querySelector("#site-structure"),n=document.querySelector("#site-structure .footer .first"),s=document.querySelector("#site-structure .footer .second");r(n,"GENGYUAN HUANG & YUAN FANG"),r(s,"@ 2022 WNFA Posters Generator");const o=document.querySelector("#site-console .input"),c=[["Type into this area to write a poem,\nthen, click the TV to generate the poster.",.075],["点击这里写一首诗，\n然后点击电视机开始生成海报。",.2],["荷叶滴落泪水，来不及浸透书页。\n一百年一千年，点燃一片通电的网。\n\n回想回想，\n那心的铁片，\n也要发出轰响。",.2]],a=()=>{const e=c.shift();var t,r,n,s,i;c.push(e),t=e[0],r=e[1],n=()=>o.placeholder,s=e=>o.placeholder=e,i=()=>{setTimeout((()=>{!function(e,t,r,n){const s=()=>{setTimeout((()=>{var e;""!==t()?(e=t().slice(0,-1),o.placeholder=e,s()):setTimeout((()=>{a()}),2e3)}),.05*Math.random()*1e3)};s()}(0,(()=>o.placeholder))}),2e3)},(e=>{let t=0;const o=()=>{setTimeout((()=>{if(t<e.length){const r=e[t++];s(n()+r),o()}else i()}),Math.random()*r*1e3+25)};o()})(t)};a();const i=document.querySelector("#site-structure .prompt");r(i,"System Ready / 系统就绪");const u=document.querySelector("#site-structure .floor .monitor"),l=document.querySelector("#site-structure .floor .monitor .poster");let d,p,m="";l.src=t;const h=()=>{var n,s,c;""!==o.value&&o.value!==m&&(r(i,"Generating / 生成中"),e.classList.add("processing"),n=o.value,s=n=>{p=f,e.classList.remove("processing"),r(i,"Poster Ready / 海报就绪"),l.src="data:image/jpeg; base64, "+n.image_data,m=o.value,o.addEventListener("input",(()=>{p=h,m="",l.src=t,r(i,"System Ready / 系统就绪")}),{once:!0})},c=t=>{switch(e.classList.remove("processing"),console.error("ERROR: "+t),t){case 1003:r(i,"Network Error / 网络错误");break;case 1002:r(i,"Sever Error / 服务器错误");break;case 1001:m=o.value,r(i,"Invalid input / 文本不规范")}},fetch("https://wnfafunctions.azurewebsites.net/api/wnfapostersgen",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n})}).then((e=>{200===e.status?e.json().then((e=>{s(e)})):400===e.status?c(1001):c(1002)})).catch((()=>{c(1003)})))},f=()=>{const e=document.querySelector("#site-posterview");e.innerHTML="";const t=document.createElement("img");t.classList.add("poster"),t.src=l.src,e.appendChild(t),e.addEventListener("click",(()=>{e.classList.remove("show")}),{once:!0}),e.classList.add("show")};d=()=>{},p=h,function(e,t,r){let n=!1;e.addEventListener("touchstart",(e=>{e.preventDefault(),n=!0,t()})),e.addEventListener("touchend",(e=>{e.preventDefault(),n=!1,r()})),e.addEventListener("touchcancel",(e=>{e.preventDefault(),n=!1,r()})),e.addEventListener("mousedown",(e=>{e.preventDefault(),n=!0,t()})),e.addEventListener("mouseup",(e=>{e.preventDefault(),n=!1,r()})),document.addEventListener("mouseup",(e=>{n&&(n=!1,r())}))}(u,(()=>{u.classList.add("pressed")}),(()=>{u.classList.remove("pressed"),p()}))}window.addEventListener("load",(function(){n()}))})();