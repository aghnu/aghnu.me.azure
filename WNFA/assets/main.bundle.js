(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var r=e.g.document;if(!t&&r&&(r.currentScript&&(t=r.currentScript.src),!t)){var n=r.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=e.p+"08e1a671094cefd9763ac7d23b49f82c.gif",r=e.p+"a9f922bba8d7596a41d38baae885e583.png";function n(e,t){e.innerHTML="";let r=!0;for(let n=0;n<t.length;n++){const o=document.createElement("span"),s=1.5*Math.random()+1,a=1,c=.25*Math.random()+.1;let i;o.style.transition=`opacity ${s}s`,o.innerHTML=t[n],o.style.opacity=[a,c][Math.floor(2*Math.random())];const d=()=>{o.style.opacity===String(a)?o.style.opacity=String(c):o.style.opacity=String(a),i=setTimeout((()=>{r&&d()}),1e3*Math.random()+1e3*s)};i=setTimeout((()=>{d()}),100),e.appendChild(o)}return()=>{r=!1}}const o={frameInit:!1,posterInit:!1,fontsLoaded:!1};function s(){const e=document.querySelector("#site-structure"),s=document.querySelector("#site-structure .footer .first"),a=document.querySelector("#site-structure .footer .second");n(s,"GENGYUAN HUANG & YUAN FANG"),n(a,"© 2022 WNFA Posters Generator");const c=document.querySelector("#site-console .input"),i=[["Type into this area to write a poem, then, click the TV to generate the poster.",.075],["点击这里写一首诗，然后点击电视机开始生成海报。",.2],["荷叶滴落泪水，来不及浸透书页。\n一百年一千年，点燃一片通电的网。\n\n回想回想，\n那心的铁片，\n也要发出轰响。",.2]],d=()=>{const e=i.shift();var t,r,n,o,s;i.push(e),t=e[0],r=e[1],n=()=>c.placeholder,o=e=>c.placeholder=e,s=()=>{setTimeout((()=>{!function(e,t,r,n){const o=()=>{setTimeout((()=>{var e;""!==t()?(e=t().slice(0,-1),c.placeholder=e,o()):setTimeout((()=>{d()}),2e3)}),.05*Math.random()*1e3)};o()}(0,(()=>c.placeholder))}),2e3)},(e=>{let t=0;const a=()=>{setTimeout((()=>{if(t<e.length){const r=e[t++];o(n()+r),a()}else s()}),Math.random()*r*1e3+25)};a()})(t)};d();const u=document.querySelector("#site-structure .prompt");n(u,"System Ready / 系统就绪");const l=document.querySelector("#site-structure .floor .monitor"),p=document.querySelector("#site-structure .floor .monitor .poster");let m,f,h="";const v=()=>{var r,o,s;""!==c.value&&c.value!==h&&(n(u,"Generating / 生成中"),e.classList.add("processing"),c.blur(),r=c.value,o=r=>{f=y,e.classList.remove("processing"),n(u,"Poster Ready / 海报就绪"),p.src="data:image/jpeg; base64, "+r.image_data,h=c.value,c.addEventListener("input",(()=>{f=v,h="",p.src=t,n(u,"System Ready / 系统就绪")}),{once:!0})},s=t=>{switch(e.classList.remove("processing"),console.error("ERROR: "+t),t){case 1003:n(u,"Network Error / 网络错误");break;case 1002:n(u,"Sever Error / 服务器错误");break;case 1001:h=c.value,n(u,"Invalid input / 文本不规范")}},fetch("https://wnfafunctions.azurewebsites.net/api/wnfapostersgen",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:r})}).then((e=>{200===e.status?e.json().then((e=>{o(e)})):400===e.status?s(1001):s(1002)})).catch((()=>{s(1003)})))},y=()=>{const e=document.querySelector("#site-posterview");e.innerHTML="";const t=document.createElement("img");t.classList.add("poster"),t.src=p.src,e.appendChild(t),e.addEventListener("click",(()=>{e.classList.remove("show")}),{once:!0}),e.classList.add("show")};m=()=>{},f=v,function(e,t,r){let n=!1;e.addEventListener("touchstart",(e=>{e.preventDefault(),n=!0,t()})),e.addEventListener("touchend",(e=>{e.preventDefault(),n=!1,r()})),e.addEventListener("touchcancel",(e=>{e.preventDefault(),n=!1,r()})),e.addEventListener("mousedown",(e=>{e.preventDefault(),n=!0,t()})),e.addEventListener("mouseup",(e=>{e.preventDefault(),n=!1,r()})),document.addEventListener("mouseup",(e=>{n&&(n=!1,r())}))}(l,(()=>{l.classList.add("pressed")}),(()=>{l.classList.remove("pressed"),f()}));const g=document.querySelector("#site-structure .floor .monitor .monitor-frame");p.addEventListener("load",(()=>{o.posterInit=!0}),{once:!0}),g.addEventListener("load",(()=>{o.frameInit=!0}),{once:!0}),p.src=t,g.src=r,document.fonts.ready.then((()=>{o.fontsLoaded=!0}))}window.addEventListener("load",(function(){s(),document.querySelector("#site-informative .loading");const e=document.querySelector("#site-informative .loading .prompt"),t=["·","· ·","· · ·"];let r=0,n=()=>{};setInterval((()=>{e.innerHTML="Loading / 载入中<br>"+t[r],r=(r+1)%t.length,n()}),750),setTimeout((()=>{n=()=>{o.frameInit&&o.posterInit&&o.fontsLoaded&&document.querySelector("#site-informative .loading").classList.add("hide")}}),2250)}))})();